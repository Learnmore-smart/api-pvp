<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>API PVP &mdash; Control Client</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- SETUP SCREEN -->
<div id="setup-screen" class="screen active">
  <div class="card setup-card">
    <h1>API PVP</h1>
    <p class="subtitle">Keyboard + aim pad control client.</p>

    <label>Server URL
      <input id="server-url" type="url" value="https://api-pvp-production.up.railway.app"
             placeholder="https://api-pvp-production.up.railway.app" />
    </label>

    <label>Username
      <input id="username" type="text" maxlength="20" placeholder="Enter your name" autocomplete="off" />
    </label>

    <button id="register-btn" class="btn-primary">Register &amp; Connect</button>
    <p id="setup-error" class="error-msg hidden"></p>

    <div class="keybind-preview">
      <div class="kb-row">
        <span class="key">W</span><span class="key">A</span><span class="key">S</span><span class="key">D</span>
        <span class="key-label">Move</span>
      </div>
      <div class="kb-row">
        <span class="key wide">Space</span><span class="key-label">Shoot (aim pad angle)</span>
      </div>
      <div class="kb-row">
        <span class="key wide">Shift</span><span class="key-label">Shield (5&#9889;)</span>
      </div>
      <div class="kb-row">
        <span class="key">R</span><span class="key-label">Reload</span>
        <span class="key">F</span><span class="key-label">Dash (8&#9889;)</span>
      </div>
      <div class="kb-row">
        <span class="key dir-key">&#8679;</span><span class="key dir-key">&#8678;</span>
        <span class="key dir-key">&#8681;</span><span class="key dir-key">&#8680;</span>
        <span class="key-label">Arrow keys also shoot</span>
      </div>
    </div>
  </div>
</div>

<!-- GAME SCREEN -->
<div id="game-screen" class="screen">

  <header id="top-bar">
    <div class="player-id-block">
      <span id="display-name" class="player-name">&mdash;</span>
      <span id="player-id-display" class="player-id">&mdash;</span>
    </div>
    <div id="mode-badge" class="badge badge-sandbox">SANDBOX</div>
    <button id="disconnect-btn" class="btn-ghost">Disconnect</button>
  </header>

  <main>
    <div class="cols">

      <!-- Stats -->
      <section class="card stats-card">
        <h2>Status</h2>

        <div class="stat-row">
          <span class="stat-label">HP</span>
          <div class="bar-wrap"><div id="bar-hp" class="bar bar-hp" style="width:100%"></div></div>
          <span id="val-hp" class="stat-val">100</span>
        </div>

        <div class="stat-row">
          <span class="stat-label">Ammo</span>
          <div class="ammo-pips" id="ammo-pips"></div>
          <span id="val-ammo" class="stat-val">5/5</span>
        </div>

        <div class="stat-row">
          <span class="stat-label">Energy</span>
          <div class="bar-wrap"><div id="bar-energy" class="bar bar-energy" style="width:100%"></div></div>
          <span id="val-energy" class="stat-val">25</span>
        </div>

        <div class="stat-row">
          <span class="stat-label">Kills</span>
          <span id="val-kills" class="stat-val big">0</span>
        </div>

        <div class="divider"></div>

        <div class="cooldown-row">
          <div id="ind-shield" class="indicator">&#128737; Shield</div>
          <div id="ind-reload" class="indicator">&#8635; Reload CD</div>
          <div id="ind-dead"   class="indicator hidden">&#128128; Dead</div>
        </div>

        <div class="divider"></div>
        <div id="last-action" class="last-action">&mdash;</div>
      </section>

      <!-- Controls + Aim pad -->
      <section class="card keys-card">
        <h2>Controls</h2>

        <div class="key-block">
          <div class="key-group-label">Move</div>
          <div class="wasd">
            <div class="wasd-row"><div id="k-w" class="kbox">W</div></div>
            <div class="wasd-row">
              <div id="k-a" class="kbox">A</div>
              <div id="k-s" class="kbox">S</div>
              <div id="k-d" class="kbox">D</div>
            </div>
          </div>
        </div>

        <table class="key-table">
          <tr><td><div id="k-space" class="kbox wide">Space</div></td>
              <td>Shoot (aim angle)</td></tr>
          <tr><td><div id="k-shift" class="kbox wide">Shift</div></td>
              <td>Shield <span class="cost">(5&#9889;)</span></td></tr>
          <tr><td><div id="k-r" class="kbox">R</div></td>
              <td>Reload</td></tr>
          <tr><td><div id="k-f" class="kbox">F</div></td>
              <td>Dash <span class="cost">(8&#9889;)</span></td></tr>
          <tr><td>
            <div style="display:flex;gap:2px;flex-direction:column;align-items:center">
              <div id="k-up"   class="kbox">&#8679;</div>
              <div style="display:flex;gap:2px">
                <div id="k-left"  class="kbox">&#8678;</div>
                <div id="k-down"  class="kbox">&#8681;</div>
                <div id="k-right" class="kbox">&#8680;</div>
              </div>
            </div>
          </td><td>Arrow keys shoot</td></tr>
        </table>

        <!-- Aim pad -->
        <div class="aim-section">
          <div class="aim-label">Aim Pad &mdash; click or drag to aim, Space to shoot</div>
          <div class="aim-row">
            <div id="aim-pad">
              <div id="aim-line"></div>
              <div id="aim-dot"></div>
            </div>
            <div class="aim-info">
              Angle: <span id="aim-angle-display">0&deg;</span><br>
              <small>(0&deg; = right, 90&deg; = down)</small>
              <div class="aim-hint">Click pad to fire immediately</div>
            </div>
          </div>
        </div>

        <div class="divider"></div>
        <div class="hint">
          Actions are <strong>blocked</strong> when lacking ammo/energy.<br>
          Cooldown actions are <strong>retried</strong> after 80ms.
        </div>
      </section>

      <!-- Log -->
      <section class="card log-card">
        <h2>Action Log <button id="clear-log" class="btn-tiny">clear</button></h2>
        <div id="action-log"></div>
      </section>

    </div>

    <div class="server-links">
      <a id="link-bigscreen" href="#" target="_blank" class="server-link">&#128250; Big Screen</a>
      <a id="link-monitor"   href="#" target="_blank" class="server-link">&#127918; My Monitor</a>
      <a id="link-api"       href="#" target="_blank" class="server-link">&#128203; /players</a>
    </div>
  </main>
</div>

<script src="client.js"></script>
</body>
</html>
